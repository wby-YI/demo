{"remainingRequest":"C:\\Users\\xiao\\Desktop\\vue_project\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\xiao\\Desktop\\vue_project\\vue-admin-template-master\\src\\views\\acl\\role\\list.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\xiao\\Desktop\\vue_project\\vue-admin-template-master\\src\\views\\acl\\role\\list.vue","mtime":1638345809000},{"path":"C:\\Users\\xiao\\Desktop\\vue_project\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652600907899},{"path":"C:\\Users\\xiao\\Desktop\\vue_project\\vue-admin-template-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1652600964560},{"path":"C:\\Users\\xiao\\Desktop\\vue_project\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652600907899},{"path":"C:\\Users\\xiao\\Desktop\\vue_project\\vue-admin-template-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1652600973833}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgpleHBvcnQgZGVmYXVsdCB7CgogIG5hbWU6ICdSb2xlTGlzdCcsCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsaXN0TG9hZGluZzogdHJ1ZSwgLy8g5pWw5o2u5piv5ZCm5q2j5Zyo5Yqg6L29CiAgICAgIHJvbGVzOiBbXSwgLy8g6KeS6Imy5YiX6KGoCiAgICAgIHRvdGFsOiAwLCAvLyDmgLvorrDlvZXmlbAKICAgICAgcGFnZTogMSwgLy8g5b2T5YmN6aG156CBCiAgICAgIGxpbWl0OiA1LCAvLyDmr4/pobXorrDlvZXmlbAKICAgICAgdGVtcFNlYXJjaE9iajogeyAvLyDmlLbpm4bmkJzntKLmnaHku7bmlbDmja4KICAgICAgICByb2xlTmFtZTogJycsCiAgICAgIH0sCiAgICAgIHNlYXJjaE9iajogeyAvLyDlj5HpgIHor7fmsYLnmoTmnaHku7blj4LmlbDmlbDmja4KICAgICAgICByb2xlTmFtZTogJycsCiAgICAgIH0sCiAgICAgIHNlbGVjdGVkUm9sZXM6IFtdIC8vIOaJgOaciemAieS4reeahOinkuiJsuWIl+ihqAogICAgfQogIH0sCgogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldFJvbGVzKCkKICB9LAoKICBtZXRob2RzOiB7CgogICAgLyogCiAgICDlj5bmtojkv67mlLkKICAgICovCiAgICBjYW5jZWxFZGl0KHJvbGUpIHsKICAgICAgcm9sZS5yb2xlTmFtZSA9IHJvbGUub3JpZ2luUm9sZU5hbWUKICAgICAgcm9sZS5lZGl0ID0gZmFsc2UKICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCflj5bmtojop5LoibLkv67mlLknKQogICAgfSwKCiAgICAvKiAKICAgIOabtOaWsOinkuiJsgogICAgKi8KICAgIHVwZGF0ZVJvbGUgKHJvbGUpIHsKICAgICAgdGhpcy4kQVBJLnJvbGUudXBkYXRlQnlJZCh7aWQ6IHJvbGUuaWQsIHJvbGVOYW1lOiByb2xlLnJvbGVOYW1lfSkKICAgICAgICAudGhlbihyZXN1bHQgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlc3VsdC5tZXNzYWdlfHwgJ+abtOaWsOinkuiJsuaIkOWKnyEnKQogICAgICAgICAgdGhpcy5nZXRSb2xlcyh0aGlzLnBhZ2UpCiAgICAgICAgfSkKICAgIH0sCgogICAgLyogCiAgICDmr4/pobXmlbDph4/lj5HnlJ/mlLnlj5jnmoTnm5HlkKwKICAgICovCiAgICBoYW5kbGVTaXplQ2hhbmdlKHBhZ2VTaXplKSB7CiAgICAgIHRoaXMubGltaXQgPSBwYWdlU2l6ZQogICAgICB0aGlzLmdldFJvbGVzKCkKICAgIH0sCgogICAgLyogCiAgICDmt7vliqDop5LoibIKICAgICovCiAgICBhZGRSb2xlKCl7CiAgICAgIC8vIOaYvuekuua3u+WKoOeVjOmdogogICAgICB0aGlzLiRwcm9tcHQoJ+ivt+i+k+WFpeaWsOWQjeensCcsICfmt7vliqDop5LoibInLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICB9KS50aGVuKCh7IHZhbHVlIH0pID0+IHsKICAgICAgICB0aGlzLiRBUEkucm9sZS5zYXZlKHtyb2xlTmFtZTogdmFsdWV9KS50aGVuKHJlc3VsdCA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzdWx0Lm1lc3NhZ2UgfHwgJ+a3u+WKoOinkuiJsuaIkOWKnycpCiAgICAgICAgICB0aGlzLmdldFJvbGVzKCkKICAgICAgICB9KQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCflj5bmtojmt7vliqAnKQogICAgICB9KQogICAgfSwKCiAgICAvKiAKICAgIOW8guatpeiOt+WPluinkuiJsuWIhumhteWIl+ihqAogICAgKi8KICAgIGdldFJvbGVzKHBhZ2UgPSAxKSB7CiAgICAgIHRoaXMucGFnZSA9IHBhZ2UKICAgICAgdGhpcy5saXN0TG9hZGluZyA9IHRydWUKICAgICAgY29uc3Qge2xpbWl0LCBzZWFyY2hPYmp9ID0gdGhpcwogICAgICB0aGlzLiRBUEkucm9sZS5nZXRQYWdlTGlzdChwYWdlLCBsaW1pdCwgc2VhcmNoT2JqKS50aGVuKAogICAgICAgIHJlc3VsdCA9PiB7CiAgICAgICAgICBjb25zdCB7aXRlbXMsIHRvdGFsfSA9IHJlc3VsdC5kYXRhCiAgICAgICAgICB0aGlzLnJvbGVzID0gaXRlbXMubWFwKGl0ZW0gPT4gewogICAgICAgICAgICBpdGVtLmVkaXQgPSBmYWxzZSAvLyDnlKjkuo7moIfor4bmmK/lkKbmmL7npLrnvJbovpHovpPlhaXmoYbnmoTlsZ7mgKcKICAgICAgICAgICAgaXRlbS5vcmlnaW5Sb2xlTmFtZSA9IGl0ZW0ucm9sZU5hbWUgLy8g57yT5a2Y6KeS6Imy5ZCN56ewLCDnlKjkuo7lj5bmtogKICAgICAgICAgICAgcmV0dXJuIGl0ZW0KICAgICAgICAgIH0pCiAgICAgICAgICB0aGlzLnRvdGFsID0gdG90YWwKICAgICAgICB9CiAgICAgICkuZmluYWxseSgoKSA9PiB7CiAgICAgICAgdGhpcy5saXN0TG9hZGluZyA9IGZhbHNlCiAgICAgIH0pCiAgICB9LAoKICAgIC8qIAogICAg5qC55o2u5pCc57Si5p2h5Lu26L+b6KGM5pCc57SiCiAgICAqLwogICAgc2VhcmNoICgpIHsKICAgICAgdGhpcy5zZWFyY2hPYmogPSB7Li4udGhpcy50ZW1wU2VhcmNoT2JqfQogICAgICB0aGlzLmdldFJvbGVzKCkKICAgIH0sCgogICAgLyogCiAgICDph43nva7mn6Xor6LooajljZXmkJzntKLliJfooagKICAgICovCiAgICByZXNldFNlYXJjaCgpIHsKICAgICAgdGhpcy50ZW1wU2VhcmNoT2JqID0gewogICAgICAgIHJvbGVOYW1lOiAnJwogICAgICB9CiAgICAgIHRoaXMuc2VhcmNoT2JqID0gewogICAgICAgIHJvbGVOYW1lOiAnJwogICAgICB9CiAgICAgIHRoaXMuZ2V0Um9sZXMoKQogICAgfSwKCiAgICAvKiAKICAgIOWIoOmZpOaMh+WumueahOinkuiJsgogICAgKi8KICAgIHJlbW92ZVJvbGUgKHtpZCwgcm9sZU5hbWV9KSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oYOehruWumuWIoOmZpCAnJHtyb2xlTmFtZX0nIOWQlz9gLCAn5o+Q56S6JywgewogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKGFzeW5jICgpID0+IHsKICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLiRBUEkucm9sZS5yZW1vdmVCeUlkKGlkKQogICAgICAgIHRoaXMuZ2V0Um9sZXModGhpcy5yb2xlcy5sZW5ndGg9PT0xID8gdGhpcy5wYWdlLTEgOiB0aGlzLnBhZ2UpCiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlc3VsdC5tZXNzYWdlIHx8ICfliKDpmaTmiJDlip8hJykKICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgIHRoaXMuJG1lc3NhZ2UuaW5mbygn5bey5Y+W5raI5Yig6ZmkJykKICAgICAgfSkKICAgIH0sCgogICAgLyogCiAgICDlvZPooajmoLzlpI3pgInmoYbpgInpobnlj5HnlJ/lj5jljJbnmoTml7blgJnop6blj5EKICAgICovCiAgICBoYW5kbGVTZWxlY3Rpb25DaGFuZ2Uoc2VsZWN0aW9uKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRSb2xlcyA9IHNlbGVjdGlvbgogICAgfSwKCiAgICAvKiAKICAgIOaJuemHj+WIoOmZpAogICAgKi8KICAgIHJlbW92ZVJvbGVzICgpIHsKICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG5rC45LmF5Yig6Zmk6K+l6K6w5b2VLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbihhc3luYyAoKSA9PiB7CiAgICAgICAgY29uc3QgaWRzID0gdGhpcy5zZWxlY3RlZFJvbGVzLm1hcChyb2xlID0+IHJvbGUuaWQpCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy4kQVBJLnJvbGUucmVtb3ZlUm9sZXMoaWRzKQogICAgICAgIHRoaXMuZ2V0Um9sZXMoKQogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgbWVzc2FnZTogJ+aJuemHj+WIoOmZpOaIkOWKnyEnCiAgICAgICAgfSkKICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgCiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICdpbmZvJywKICAgICAgICAgIG1lc3NhZ2U6ICflt7Llj5bmtojliKDpmaQnCiAgICAgICAgfSkKICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsFA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/acl/role","sourcesContent":["<template>\n  <div>\n    <el-form inline>\n      <el-form-item>\n        <el-input v-model=\"tempSearchObj.roleName\" placeholder=\"角色名称\"/>\n      </el-form-item>\n\n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"search\">查询</el-button>\n      <el-button @click=\"resetSearch\">清空</el-button>\n    </el-form>\n\n    <div style=\"margin-bottom: 20px\">\n      <el-button type=\"primary\"  @click=\"addRole\">添加</el-button>\n      <el-button type=\"danger\" @click=\"removeRoles()\" :disabled=\"selectedRoles.length === 0\">批量删除</el-button>\n    </div>\n\n    <el-table\n      border\n      stripe\n      style=\"width: 960px\"\n      v-loading=\"listLoading\"\n      :data=\"roles\"\n      @selection-change=\"handleSelectionChange\">\n\n      <el-table-column\n        type=\"selection\"\n        width=\"55\" />\n\n      <el-table-column\n        type=\"index\"\n        label=\"序号\"\n        width=\"80\"\n        align=\"center\">\n      </el-table-column>\n\n      <el-table-column label=\"角色名称\">\n        <template slot-scope=\"{row}\">\n          <template v-if=\"row.edit\">\n            <el-input v-model=\"row.roleName\" class=\"edit-input\" size=\"small\" />\n            <el-button\n              class=\"cancel-btn\"\n              size=\"small\"\n              icon=\"el-icon-refresh\"\n              type=\"warning\"\n              @click=\"cancelEdit(row)\"\n            >\n              取消\n            </el-button>\n          </template>\n          <span v-else>{{ row.roleName }}</span>\n        </template>\n      </el-table-column>\n      \n      <el-table-column label=\"操作\" width=\"300\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <HintButton size=\"mini\" type=\"info\" icon=\"el-icon-info\" title=\"分配权限\"\n            @click=\"$router.push(`/acl/role/auth/${row.id}?roleName=${row.roleName}`)\"/>\n\n          <HintButton size=\"mini\" type=\"primary\" icon=\"el-icon-check\" title=\"确定\" \n            @click=\"updateRole(row)\" v-if=\"row.edit\"/>\n          <HintButton size=\"mini\" type=\"primary\" icon=\"el-icon-edit\" title=\"修改角色\" \n            @click=\"row.edit= true\" v-if=\"!row.edit\"/>\n\n            \n          <HintButton size=\"mini\" type=\"danger\" icon=\"el-icon-delete\" title=\"删除角色\"\n            @click=\"removeRole(row)\"/>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <!-- 分页组件 -->\n    <el-pagination\n      :current-page=\"page\"\n      :total=\"total\"\n      :page-size=\"limit\"\n      :page-sizes=\"[5, 10, 20, 30, 40, 50, 100]\"\n      style=\"padding: 20px 0;\"\n      layout=\"prev, pager, next, jumper, ->, sizes, total\"\n      @current-change=\"getRoles\"\n      @size-change=\"handleSizeChange\"\n    />\n  </div>\n</template>\n\n<script>\n\nexport default {\n\n  name: 'RoleList',\n\n  data() {\n    return {\n      listLoading: true, // 数据是否正在加载\n      roles: [], // 角色列表\n      total: 0, // 总记录数\n      page: 1, // 当前页码\n      limit: 5, // 每页记录数\n      tempSearchObj: { // 收集搜索条件数据\n        roleName: '',\n      },\n      searchObj: { // 发送请求的条件参数数据\n        roleName: '',\n      },\n      selectedRoles: [] // 所有选中的角色列表\n    }\n  },\n\n  mounted() {\n    this.getRoles()\n  },\n\n  methods: {\n\n    /* \n    取消修改\n    */\n    cancelEdit(role) {\n      role.roleName = role.originRoleName\n      role.edit = false\n      this.$message.warning('取消角色修改')\n    },\n\n    /* \n    更新角色\n    */\n    updateRole (role) {\n      this.$API.role.updateById({id: role.id, roleName: role.roleName})\n        .then(result => {\n          this.$message.success(result.message|| '更新角色成功!')\n          this.getRoles(this.page)\n        })\n    },\n\n    /* \n    每页数量发生改变的监听\n    */\n    handleSizeChange(pageSize) {\n      this.limit = pageSize\n      this.getRoles()\n    },\n\n    /* \n    添加角色\n    */\n    addRole(){\n      // 显示添加界面\n      this.$prompt('请输入新名称', '添加角色', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n      }).then(({ value }) => {\n        this.$API.role.save({roleName: value}).then(result => {\n          this.$message.success(result.message || '添加角色成功')\n          this.getRoles()\n        })\n      }).catch(() => {\n        this.$message.warning('取消添加')\n      })\n    },\n\n    /* \n    异步获取角色分页列表\n    */\n    getRoles(page = 1) {\n      this.page = page\n      this.listLoading = true\n      const {limit, searchObj} = this\n      this.$API.role.getPageList(page, limit, searchObj).then(\n        result => {\n          const {items, total} = result.data\n          this.roles = items.map(item => {\n            item.edit = false // 用于标识是否显示编辑输入框的属性\n            item.originRoleName = item.roleName // 缓存角色名称, 用于取消\n            return item\n          })\n          this.total = total\n        }\n      ).finally(() => {\n        this.listLoading = false\n      })\n    },\n\n    /* \n    根据搜索条件进行搜索\n    */\n    search () {\n      this.searchObj = {...this.tempSearchObj}\n      this.getRoles()\n    },\n\n    /* \n    重置查询表单搜索列表\n    */\n    resetSearch() {\n      this.tempSearchObj = {\n        roleName: ''\n      }\n      this.searchObj = {\n        roleName: ''\n      }\n      this.getRoles()\n    },\n\n    /* \n    删除指定的角色\n    */\n    removeRole ({id, roleName}) {\n      this.$confirm(`确定删除 '${roleName}' 吗?`, '提示', {\n        type: 'warning'\n      }).then(async () => {\n        const result = await this.$API.role.removeById(id)\n        this.getRoles(this.roles.length===1 ? this.page-1 : this.page)\n        this.$message.success(result.message || '删除成功!')\n      }).catch(() => {\n        this.$message.info('已取消删除')\n      })\n    },\n\n    /* \n    当表格复选框选项发生变化的时候触发\n    */\n    handleSelectionChange(selection) {\n      this.selectedRoles = selection\n    },\n\n    /* \n    批量删除\n    */\n    removeRoles () {\n      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {\n        type: 'warning'\n      }).then(async () => {\n        const ids = this.selectedRoles.map(role => role.id)\n        const result = await this.$API.role.removeRoles(ids)\n        this.getRoles()\n        this.$message({\n          type: 'success',\n          message: '批量删除成功!'\n        })\n      }).then((result) => {\n        \n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        })\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.edit-input {\n  padding-right: 100px;\n}\n.cancel-btn {\n  position: absolute;\n  right: 15px;\n  top: 10px;\n}\n</style>"]}]}